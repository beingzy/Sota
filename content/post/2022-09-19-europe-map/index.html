---
title: "Cartoon map of Europe"
author: "JG Pardyak"
date: "2022-09-19"
output: html_document
---

<script src="{{< blogdown/postref >}}index_files/htmlwidgets/htmlwidgets.js"></script>
<link href="{{< blogdown/postref >}}index_files/vis/vis-network.min.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/vis/vis-network.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/visNetwork-binding/visNetwork.js"></script>


<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>I can’t draw by hand so I want to draw this map with <code>R</code>. <a href="https://commons.wikimedia.org/wiki/File:Hand-Drawn_Map_of_Europe.svg" class="uri">https://commons.wikimedia.org/wiki/File:Hand-Drawn_Map_of_Europe.svg</a></p>
<p><img src="Hand-Drawn_Map_of_Europe.svg" /></p>
</div>
<div id="entities-of-europe" class="section level2">
<h2>Entities of Europe</h2>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6     ✔ purrr   0.3.4
## ✔ tibble  3.1.8     ✔ dplyr   1.0.9
## ✔ tidyr   1.2.0     ✔ stringr 1.4.1
## ✔ readr   2.1.2     ✔ forcats 0.5.1
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(sf)</code></pre>
<pre><code>## Linking to GEOS 3.9.1, GDAL 3.4.3, PROJ 7.2.1; sf_use_s2() is TRUE</code></pre>
<pre class="r"><code>library(rnaturalearth)</code></pre>
<p>We work with all entities falling even partially under any of the various common definitions of Europe, geographical or political. <a href="https://en.wikipedia.org/wiki/Europe" class="uri">https://en.wikipedia.org/wiki/Europe</a> .
Names as used in <code>rnaturalearth</code>.</p>
<pre class="r"><code>sovereignties &lt;- c(
&quot;Albania&quot;, &quot;Andorra&quot;, &quot;Armenia&quot;, &quot;Austria&quot;, &quot;Azerbaijan&quot;, &quot;Belarus&quot;, &quot;Belgium&quot;, &quot;Bosnia and Herzegovina&quot;, &quot;Bulgaria&quot;, &quot;Croatia&quot;, &quot;Cyprus&quot;, &quot;Czech Republic&quot;, &quot;Denmark&quot;, &quot;Estonia&quot;, &quot;Finland&quot;, &quot;France&quot;, &quot;Georgia&quot;, &quot;Germany&quot;, &quot;Greece&quot;, &quot;Hungary&quot;, &quot;Iceland&quot;, &quot;Ireland&quot;, &quot;Italy&quot;, &quot;Kazakhstan&quot;, &quot;Latvia&quot;, &quot;Liechtenstein&quot;, &quot;Lithuania&quot;, &quot;Luxembourg&quot;, &quot;Macedonia&quot;, &quot;Malta&quot;, &quot;Moldova&quot;, &quot;Monaco&quot;, &quot;Montenegro&quot;, &quot;Netherlands&quot;, &quot;Norway&quot;, &quot;Poland&quot;, &quot;Portugal&quot;, &quot;Republic of Serbia&quot;, &quot;Romania&quot;, &quot;Russia&quot;, &quot;San Marino&quot;, &quot;Slovakia&quot;, &quot;Slovenia&quot;, &quot;Spain&quot;, &quot;Sweden&quot;, &quot;Switzerland&quot;, &quot;Turkey&quot;, &quot;Ukraine&quot;, &quot;United Kingdom&quot;, &quot;Vatican&quot;)

europe &lt;- ne_countries(scale = &quot;medium&quot;, returnclass = &quot;sf&quot;, sovereignty = sovereignties) %&gt;%
    select(sovereignt)</code></pre>
<pre class="r"><code>europe %&gt;% ggplot() +
  geom_sf() +
  coord_sf(xlim = c(-23, 40), ylim = c(33, 70)) </code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="add-colours" class="section level2">
<h2>Add colours</h2>
<pre class="r"><code>library(igraph)</code></pre>
<pre><code>## 
## Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     as_data_frame, groups, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:purrr&#39;:
## 
##     compose, simplify</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     crossing</code></pre>
<pre><code>## The following object is masked from &#39;package:tibble&#39;:
## 
##     as_data_frame</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     union</code></pre>
<pre class="r"><code>library(visNetwork)
json &lt;- jsonlite::fromJSON(&quot;neighbours.json&quot;)
json</code></pre>
<pre><code>##                   country
## 1                 Albania
## 2                 Andorra
## 3                 Austria
## 4                 Belarus
## 5                 Belgium
## 6  Bosnia and Herzegovina
## 7                Bulgaria
## 8                 Croatia
## 9                  Cyprus
## 10         Czech Republic
## 11                Denmark
## 12                Estonia
## 13                Finland
## 14                 France
## 15                Germany
## 16                 Greece
## 17                Hungary
## 18                Iceland
## 19                Ireland
## 20                  Italy
## 21                 Kosovo
## 22                 Latvia
## 23          Liechtenstein
## 24              Lithuania
## 25              Macedonia
## 26                Moldova
## 27             Montenegro
## 28            Netherlands
## 29                 Norway
## 30                 Poland
## 31               Portugal
## 32     Republic of Serbia
## 33                Romania
## 34                 Russia
## 35               Slovakia
##                                                                                                         neighbours
## 1                                                    Greece, Italy, Montenegro, Macedonia, Kosovo, NA, M, NA, L, L
## 2                                                                                              France, Spain, L, L
## 3  Czech Republic, Germany, Hungary, Italy, Liechtenstein, Slovakia, Slovenia, Switzerland, L, L, L, L, L, L, L, L
## 4                                                        Latvia, Lithuania, Poland, Russia, Ukraine, L, L, L, L, L
## 5                                        France, Germany, Luxembourg, Netherlands, United Kingdom, NA, L, L, NA, M
## 6                                                                Croatia, Montenegro, Republic of Serbia, NA, L, L
## 7                               Greece, Macedonia, Romania, Republic of Serbia, Russia, Ukraine, L, L, NA, L, M, M
## 8                                        Hungary, Italy, Montenegro, Republic of Serbia, Slovenia, L, M, NA, L, NA
## 9                                                                                                        Greece, M
## 10                                                                              Germany, Poland, Slovakia, L, L, L
## 11                                                 Germany, Norway, Poland, Sweden, United Kingdom, NA, M, M, M, M
## 12                                                                   Finland, Latvia, Russia, Sweden, M, NA, NA, M
## 13                                                                               Norway, Russia, Sweden, L, NA, NA
## 14                  Germany, Italy, Luxembourg, Monaco, Spain, Switzerland, United Kingdom, L, NA, L, NA, NA, L, M
## 15                        Luxembourg, Netherlands, Poland, Sweden, Switzerland, United Kingdom, L, NA, NA, M, L, M
## 16                                                                                          Italy, Macedonia, M, L
## 17                                         Romania, Republic of Serbia, Slovakia, Slovenia, Ukraine, L, L, L, L, L
## 18                                                                                           Denmark, Norway, M, M
## 19                                                                                                  United Kingdom
## 20                      Malta, Montenegro, San Marino, Slovenia, Spain, Switzerland, Vatican, M, M, L, NA, M, L, L
## 21                                                              Montenegro, Macedonia, Republic of Serbia, L, L, L
## 22                                                                             Lithuania, Russia, Sweden, NA, L, M
## 23                                                                                                  Switzerland, L
## 24                                                                                Poland, Russia, Sweden, L, NA, M
## 25                                                                                           Republic of Serbia, L
## 26                                                                                          Romania, Ukraine, L, L
## 27                                                                                           Republic of Serbia, L
## 28                                                                                               United Kingdom, M
## 29                                                                       Russia, Sweden, United Kingdom, NA, NA, M
## 30                                                                  Russia, Slovakia, Sweden, Ukraine, NA, L, M, L
## 31                                                                                                           Spain
## 32                                                                                                      Romania, L
## 33                                                                   Russia, Republic of Serbia, Ukraine, M, L, NA
## 34                                                                                          Sweden, Ukraine, M, NA
## 35                                                                                                      Ukraine, L</code></pre>
<pre class="r"><code>json %&gt;% slice(1)  %&gt;% select(neighbours) %&gt;% 
    first()</code></pre>
<pre><code>## [[1]]
##    neighbour type
## 1     Greece &lt;NA&gt;
## 2      Italy    M
## 3 Montenegro &lt;NA&gt;
## 4  Macedonia    L
## 5     Kosovo    L</code></pre>
<pre class="r"><code>countries &lt;- json %&gt;% select(country) %&gt;% pull()

neighbours &lt;- tibble()
for (cnt in countries) {
  row &lt;- json %&gt;% filter(country == cnt) %&gt;% select(neighbours) %&gt;% pull() %&gt;% 
    first() %&gt;% mutate(country = cnt)
  neighbours &lt;- neighbours %&gt;% bind_rows(row)
}

d &lt;- neighbours %&gt;% select(country, neighbour)
countries &lt;- union(neighbours %&gt;% select(country)  %&gt;% distinct() %&gt;% pull(),
                   neighbours %&gt;% select(neighbour)  %&gt;% distinct() %&gt;% pull())
igraph_network &lt;- graph_from_data_frame(d = d, vertices = countries, directed = F)</code></pre>
<pre class="r"><code>plot(igraph_network)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>E(igraph_network)</code></pre>
<pre><code>## + 115/115 edges from e56ba4e (vertex names):
##  [1] Albania--Greece         Albania--Italy          Albania--Montenegro    
##  [4] Albania--Macedonia      Albania--Kosovo         Andorra--France        
##  [7] Andorra--Spain          Austria--Czech Republic Austria--Germany       
## [10] Austria--Hungary        Austria--Italy          Austria--Liechtenstein 
## [13] Austria--Slovakia       Austria--Slovenia       Austria--Switzerland   
## [16] Belarus--Latvia         Belarus--Lithuania      Belarus--Poland        
## [19] Belarus--Russia         Belarus--Ukraine        Belgium--France        
## [22] Belgium--Germany        Belgium--Luxembourg     Belgium--Netherlands   
## [25] Belgium--United Kingdom
## + ... omitted several edges</code></pre>
<pre class="r"><code>V(igraph_network)</code></pre>
<pre><code>## + 46/46 vertices, named, from e56ba4e:
##  [1] Albania                Andorra                Austria               
##  [4] Belarus                Belgium                Bosnia and Herzegovina
##  [7] Bulgaria               Croatia                Cyprus                
## [10] Czech Republic         Denmark                Estonia               
## [13] Finland                France                 Germany               
## [16] Greece                 Hungary                Iceland               
## [19] Ireland                Italy                  Kosovo                
## [22] Latvia                 Liechtenstein          Lithuania             
## [25] Macedonia              Moldova                Montenegro            
## [28] Netherlands            Norway                 Poland                
## + ... omitted several vertices</code></pre>
<pre class="r"><code>E(igraph_network)</code></pre>
<pre><code>## + 115/115 edges from e56ba4e (vertex names):
##  [1] Albania--Greece         Albania--Italy          Albania--Montenegro    
##  [4] Albania--Macedonia      Albania--Kosovo         Andorra--France        
##  [7] Andorra--Spain          Austria--Czech Republic Austria--Germany       
## [10] Austria--Hungary        Austria--Italy          Austria--Liechtenstein 
## [13] Austria--Slovakia       Austria--Slovenia       Austria--Switzerland   
## [16] Belarus--Latvia         Belarus--Lithuania      Belarus--Poland        
## [19] Belarus--Russia         Belarus--Ukraine        Belgium--France        
## [22] Belgium--Germany        Belgium--Luxembourg     Belgium--Netherlands   
## [25] Belgium--United Kingdom
## + ... omitted several edges</code></pre>
<pre class="r"><code>igraph_network[]</code></pre>
<pre><code>## 46 x 46 sparse Matrix of class &quot;dgCMatrix&quot;</code></pre>
<pre><code>##    [[ suppressing 46 column names &#39;Albania&#39;, &#39;Andorra&#39;, &#39;Austria&#39; ... ]]</code></pre>
<pre><code>##                                                                               
## Albania                . . . . . . . . . . . . . . . 1 . . . 1 1 . . . 1 . 1 .
## Andorra                . . . . . . . . . . . . . 1 . . . . . . . . . . . . . .
## Austria                . . . . . . . . . 1 . . . . 1 . 1 . . 1 . . 1 . . . . .
## Belarus                . . . . . . . . . . . . . . . . . . . . . 1 . 1 . . . .
## Belgium                . . . . . . . . . . . . . 1 1 . . . . . . . . . . . . 1
## Bosnia and Herzegovina . . . . . . . 1 . . . . . . . . . . . . . . . . . . 1 .
## Bulgaria               . . . . . . . . . . . . . . . 1 . . . . . . . . 1 . . .
## Croatia                . . . . . 1 . . . . . . . . . . 1 . . 1 . . . . . . 1 .
## Cyprus                 . . . . . . . . . . . . . . . 1 . . . . . . . . . . . .
## Czech Republic         . . 1 . . . . . . . . . . . 1 . . . . . . . . . . . . .
## Denmark                . . . . . . . . . . . . . . 1 . . 1 . . . . . . . . . .
## Estonia                . . . . . . . . . . . . 1 . . . . . . . . 1 . . . . . .
## Finland                . . . . . . . . . . . 1 . . . . . . . . . . . . . . . .
## France                 . 1 . . 1 . . . . . . . . . 1 . . . . 1 . . . . . . . .
## Germany                . . 1 . 1 . . . . 1 1 . . 1 . . . . . . . . . . . . . 1
## Greece                 1 . . . . . 1 . 1 . . . . . . . . . . 1 . . . . 1 . . .
## Hungary                . . 1 . . . . 1 . . . . . . . . . . . . . . . . . . . .
## Iceland                . . . . . . . . . . 1 . . . . . . . . . . . . . . . . .
## Ireland                . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## Italy                  1 . 1 . . . . 1 . . . . . 1 . 1 . . . . . . . . . . 1 .
## Kosovo                 1 . . . . . . . . . . . . . . . . . . . . . . . 1 . 1 .
## Latvia                 . . . 1 . . . . . . . 1 . . . . . . . . . . . 1 . . . .
## Liechtenstein          . . 1 . . . . . . . . . . . . . . . . . . . . . . . . .
## Lithuania              . . . 1 . . . . . . . . . . . . . . . . . 1 . . . . . .
## Macedonia              1 . . . . . 1 . . . . . . . . 1 . . . . 1 . . . . . . .
## Moldova                . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## Montenegro             1 . . . . 1 . 1 . . . . . . . . . . . 1 1 . . . . . . .
## Netherlands            . . . . 1 . . . . . . . . . 1 . . . . . . . . . . . . .
## Norway                 . . . . . . . . . . 1 . 1 . . . . 1 . . . . . . . . . .
## Poland                 . . . 1 . . . . . 1 1 . . . 1 . . . . . . . . 1 . . . .
## Portugal               . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## Republic of Serbia     . . . . . 1 1 1 . . . . . . . . 1 . . . 1 . . . 1 . 1 .
## Romania                . . . . . . 1 . . . . . . . . . 1 . . . . . . . . 1 . .
## Russia                 . . . 1 . . 1 . . . . 1 1 . . . . . . . . 1 . 1 . . . .
## Slovakia               . . 1 . . . . . . 1 . . . . . . 1 . . . . . . . . . . .
## Spain                  . 1 . . . . . . . . . . . 1 . . . . . 1 . . . . . . . .
## Slovenia               . . 1 . . . . 1 . . . . . . . . 1 . . 1 . . . . . . . .
## Switzerland            . . 1 . . . . . . . . . . 1 1 . . . . 1 . . 1 . . . . .
## Ukraine                . . . 1 . . 1 . . . . . . . . . 1 . . . . . . . . 1 . .
## Luxembourg             . . . . 1 . . . . . . . . 1 1 . . . . . . . . . . . . .
## United Kingdom         . . . . 1 . . . . . 1 . . 1 1 . . . 1 . . . . . . . . 1
## Sweden                 . . . . . . . . . . 1 1 1 . 1 . . . . . . 1 . 1 . . . .
## Monaco                 . . . . . . . . . . . . . 1 . . . . . . . . . . . . . .
## Malta                  . . . . . . . . . . . . . . . . . . . 1 . . . . . . . .
## San Marino             . . . . . . . . . . . . . . . . . . . 1 . . . . . . . .
## Vatican                . . . . . . . . . . . . . . . . . . . 1 . . . . . . . .
##                                                           
## Albania                . . . . . . . . . . . . . . . . . .
## Andorra                . . . . . . . 1 . . . . . . . . . .
## Austria                . . . . . . 1 . 1 1 . . . . . . . .
## Belarus                . 1 . . . 1 . . . . 1 . . . . . . .
## Belgium                . . . . . . . . . . . 1 1 . . . . .
## Bosnia and Herzegovina . . . 1 . . . . . . . . . . . . . .
## Bulgaria               . . . 1 1 1 . . . . 1 . . . . . . .
## Croatia                . . . 1 . . . . 1 . . . . . . . . .
## Cyprus                 . . . . . . . . . . . . . . . . . .
## Czech Republic         . 1 . . . . 1 . . . . . . . . . . .
## Denmark                1 1 . . . . . . . . . . 1 1 . . . .
## Estonia                . . . . . 1 . . . . . . . 1 . . . .
## Finland                1 . . . . 1 . . . . . . . 1 . . . .
## France                 . . . . . . . 1 . 1 . 1 1 . 1 . . .
## Germany                . 1 . . . . . . . 1 . 1 1 1 . . . .
## Greece                 . . . . . . . . . . . . . . . . . .
## Hungary                . . . 1 1 . 1 . 1 . 1 . . . . . . .
## Iceland                1 . . . . . . . . . . . . . . . . .
## Ireland                . . . . . . . . . . . . 1 . . . . .
## Italy                  . . . . . . . 1 1 1 . . . . . 1 1 1
## Kosovo                 . . . 1 . . . . . . . . . . . . . .
## Latvia                 . . . . . 1 . . . . . . . 1 . . . .
## Liechtenstein          . . . . . . . . . 1 . . . . . . . .
## Lithuania              . 1 . . . 1 . . . . . . . 1 . . . .
## Macedonia              . . . 1 . . . . . . . . . . . . . .
## Moldova                . . . . 1 . . . . . 1 . . . . . . .
## Montenegro             . . . 1 . . . . . . . . . . . . . .
## Netherlands            . . . . . . . . . . . . 1 . . . . .
## Norway                 . . . . . 1 . . . . . . 1 1 . . . .
## Poland                 . . . . . 1 1 . . . 1 . . 1 . . . .
## Portugal               . . . . . . . 1 . . . . . . . . . .
## Republic of Serbia     . . . . 2 . . . . . . . . . . . . .
## Romania                . . . 2 . 1 . . . . 1 . . . . . . .
## Russia                 1 1 . . 1 . . . . . 1 . . 1 . . . .
## Slovakia               . 1 . . . . . . . . 1 . . . . . . .
## Spain                  . . 1 . . . . . . . . . . . . . . .
## Slovenia               . . . . . . . . . . . . . . . . . .
## Switzerland            . . . . . . . . . . . . . . . . . .
## Ukraine                . 1 . . 1 1 1 . . . . . . . . . . .
## Luxembourg             . . . . . . . . . . . . . . . . . .
## United Kingdom         1 . . . . . . . . . . . . . . . . .
## Sweden                 1 1 . . . 1 . . . . . . . . . . . .
## Monaco                 . . . . . . . . . . . . . . . . . .
## Malta                  . . . . . . . . . . . . . . . . . .
## San Marino             . . . . . . . . . . . . . . . . . .
## Vatican                . . . . . . . . . . . . . . . . . .</code></pre>
<pre class="r"><code>diam &lt;- get_diameter(igraph_network, directed=T)
diam</code></pre>
<pre><code>## + 7/46 vertices, named, from e56ba4e:
## [1] Moldova  Romania  Bulgaria Greece   Italy    Spain    Portugal</code></pre>
<pre class="r"><code># visNetwork
data &lt;- toVisNetworkData(igraph_network)
visNetwork(nodes = data$nodes, edges = data$edges, height = &quot;500px&quot;)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:500px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"nodes":{"id":["Albania","Andorra","Austria","Belarus","Belgium","Bosnia and Herzegovina","Bulgaria","Croatia","Cyprus","Czech Republic","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","Ireland","Italy","Kosovo","Latvia","Liechtenstein","Lithuania","Macedonia","Moldova","Montenegro","Netherlands","Norway","Poland","Portugal","Republic of Serbia","Romania","Russia","Slovakia","Spain","Slovenia","Switzerland","Ukraine","Luxembourg","United Kingdom","Sweden","Monaco","Malta","San Marino","Vatican"],"label":["Albania","Andorra","Austria","Belarus","Belgium","Bosnia and Herzegovina","Bulgaria","Croatia","Cyprus","Czech Republic","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","Ireland","Italy","Kosovo","Latvia","Liechtenstein","Lithuania","Macedonia","Moldova","Montenegro","Netherlands","Norway","Poland","Portugal","Republic of Serbia","Romania","Russia","Slovakia","Spain","Slovenia","Switzerland","Ukraine","Luxembourg","United Kingdom","Sweden","Monaco","Malta","San Marino","Vatican"]},"edges":{"from":["Albania","Albania","Albania","Albania","Albania","Andorra","Andorra","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Belarus","Belarus","Belarus","Belarus","Belarus","Belgium","Belgium","Belgium","Belgium","Belgium","Bosnia and Herzegovina","Bosnia and Herzegovina","Bosnia and Herzegovina","Bulgaria","Bulgaria","Bulgaria","Bulgaria","Bulgaria","Bulgaria","Croatia","Croatia","Croatia","Croatia","Croatia","Cyprus","Czech Republic","Czech Republic","Czech Republic","Denmark","Denmark","Denmark","Denmark","Denmark","Estonia","Estonia","Estonia","Estonia","Finland","Finland","Finland","France","France","France","France","France","France","France","Germany","Germany","Germany","Germany","Germany","Germany","Greece","Greece","Hungary","Hungary","Hungary","Hungary","Hungary","Denmark","Iceland","Ireland","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Kosovo","Kosovo","Kosovo","Latvia","Latvia","Latvia","Liechtenstein","Lithuania","Lithuania","Lithuania","Macedonia","Moldova","Moldova","Montenegro","Netherlands","Norway","Norway","Norway","Poland","Poland","Poland","Poland","Portugal","Republic of Serbia","Romania","Republic of Serbia","Romania","Russia","Russia","Slovakia"],"to":["Greece","Italy","Montenegro","Macedonia","Kosovo","France","Spain","Czech Republic","Germany","Hungary","Italy","Liechtenstein","Slovakia","Slovenia","Switzerland","Latvia","Lithuania","Poland","Russia","Ukraine","France","Germany","Luxembourg","Netherlands","United Kingdom","Croatia","Montenegro","Republic of Serbia","Greece","Macedonia","Romania","Republic of Serbia","Russia","Ukraine","Hungary","Italy","Montenegro","Republic of Serbia","Slovenia","Greece","Germany","Poland","Slovakia","Germany","Norway","Poland","Sweden","United Kingdom","Finland","Latvia","Russia","Sweden","Norway","Russia","Sweden","Germany","Italy","Luxembourg","Monaco","Spain","Switzerland","United Kingdom","Luxembourg","Netherlands","Poland","Sweden","Switzerland","United Kingdom","Italy","Macedonia","Romania","Republic of Serbia","Slovakia","Slovenia","Ukraine","Iceland","Norway","United Kingdom","Malta","Montenegro","San Marino","Slovenia","Spain","Switzerland","Vatican","Montenegro","Macedonia","Republic of Serbia","Lithuania","Russia","Sweden","Switzerland","Poland","Russia","Sweden","Republic of Serbia","Romania","Ukraine","Republic of Serbia","United Kingdom","Russia","Sweden","United Kingdom","Russia","Slovakia","Sweden","Ukraine","Spain","Romania","Russia","Romania","Ukraine","Sweden","Ukraine","Ukraine"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false}},"groups":null,"width":null,"height":"500px","idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>data$nodes &lt;- greedy_vertex_coloring(
  igraph_network, 
  heuristic = c(&quot;colored_neighbors&quot;)) %&gt;% 
  tibble(label = names(.),
       col_id = .) %&gt;%
  left_join(tibble(col_id = c(1:5),
                   color = c(&quot;#f0e442ff&quot;, &quot;#009e73ff&quot;, &quot;#d55e00ff&quot;, &quot;#0072b2ff&quot;, &quot;#44b9bfff&quot;))) %&gt;%
  select(label, color) %&gt;% mutate(id = label)</code></pre>
<pre><code>## Joining, by = &quot;col_id&quot;</code></pre>
<pre class="r"><code>data$edges &lt;- neighbours %&gt;% rename(from = country, to = neighbour) %&gt;% 
  mutate_at(c(&#39;type&#39;), ~replace_na(., &quot;B&quot;))  %&gt;%
  left_join(tibble(type = c(&quot;B&quot;, &quot;M&quot;, &quot;L&quot;),
                   color = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;)))</code></pre>
<pre><code>## Joining, by = &quot;type&quot;</code></pre>
<pre class="r"><code>visNetwork(nodes = data$nodes, edges = data$edges, width = &quot;1000px&quot;, height = &quot;1000px&quot;) %&gt;% 
  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE)</code></pre>
<div id="htmlwidget-2" style="width:1000px;height:1000px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"nodes":{"label":["Albania","Andorra","Austria","Belarus","Belgium","Bosnia and Herzegovina","Bulgaria","Croatia","Cyprus","Czech Republic","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","Ireland","Italy","Kosovo","Latvia","Liechtenstein","Lithuania","Macedonia","Moldova","Montenegro","Netherlands","Norway","Poland","Portugal","Republic of Serbia","Romania","Russia","Slovakia","Spain","Slovenia","Switzerland","Ukraine","Luxembourg","United Kingdom","Sweden","Monaco","Malta","San Marino","Vatican"],"color":["#009e73ff","#f0e442ff","#d55e00ff","#44b9bfff","#0072b2ff","#f0e442ff","#d55e00ff","#d55e00ff","#f0e442ff","#009e73ff","#0072b2ff","#f0e442ff","#d55e00ff","#d55e00ff","#f0e442ff","#0072b2ff","#0072b2ff","#009e73ff","#f0e442ff","#f0e442ff","#d55e00ff","#d55e00ff","#f0e442ff","#f0e442ff","#f0e442ff","#d55e00ff","#0072b2ff","#d55e00ff","#f0e442ff","#d55e00ff","#f0e442ff","#009e73ff","#f0e442ff","#0072b2ff","#f0e442ff","#009e73ff","#009e73ff","#009e73ff","#009e73ff","#009e73ff","#009e73ff","#009e73ff","#f0e442ff","#009e73ff","#009e73ff","#009e73ff"],"id":["Albania","Andorra","Austria","Belarus","Belgium","Bosnia and Herzegovina","Bulgaria","Croatia","Cyprus","Czech Republic","Denmark","Estonia","Finland","France","Germany","Greece","Hungary","Iceland","Ireland","Italy","Kosovo","Latvia","Liechtenstein","Lithuania","Macedonia","Moldova","Montenegro","Netherlands","Norway","Poland","Portugal","Republic of Serbia","Romania","Russia","Slovakia","Spain","Slovenia","Switzerland","Ukraine","Luxembourg","United Kingdom","Sweden","Monaco","Malta","San Marino","Vatican"]},"edges":{"to":["Greece","Italy","Montenegro","Macedonia","Kosovo","France","Spain","Czech Republic","Germany","Hungary","Italy","Liechtenstein","Slovakia","Slovenia","Switzerland","Latvia","Lithuania","Poland","Russia","Ukraine","France","Germany","Luxembourg","Netherlands","United Kingdom","Croatia","Montenegro","Republic of Serbia","Greece","Macedonia","Romania","Republic of Serbia","Russia","Ukraine","Hungary","Italy","Montenegro","Republic of Serbia","Slovenia","Greece","Germany","Poland","Slovakia","Germany","Norway","Poland","Sweden","United Kingdom","Finland","Latvia","Russia","Sweden","Norway","Russia","Sweden","Germany","Italy","Luxembourg","Monaco","Spain","Switzerland","United Kingdom","Luxembourg","Netherlands","Poland","Sweden","Switzerland","United Kingdom","Italy","Macedonia","Romania","Republic of Serbia","Slovakia","Slovenia","Ukraine","Denmark","Norway","United Kingdom","Malta","Montenegro","San Marino","Slovenia","Spain","Switzerland","Vatican","Montenegro","Macedonia","Republic of Serbia","Lithuania","Russia","Sweden","Switzerland","Poland","Russia","Sweden","Republic of Serbia","Romania","Ukraine","Republic of Serbia","United Kingdom","Russia","Sweden","United Kingdom","Russia","Slovakia","Sweden","Ukraine","Spain","Romania","Russia","Republic of Serbia","Ukraine","Sweden","Ukraine","Ukraine"],"type":["B","M","B","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","B","L","L","B","M","B","L","L","L","L","B","L","M","M","L","M","B","L","B","M","L","L","L","B","M","M","M","M","M","B","B","M","L","B","B","L","B","L","B","B","L","M","L","B","B","M","L","M","M","L","L","L","L","L","L","M","M","B","M","M","L","B","M","L","L","L","L","L","B","L","M","L","L","B","M","L","L","L","L","M","B","B","M","B","L","M","L","B","L","M","L","B","M","B","L"],"from":["Albania","Albania","Albania","Albania","Albania","Andorra","Andorra","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Belarus","Belarus","Belarus","Belarus","Belarus","Belgium","Belgium","Belgium","Belgium","Belgium","Bosnia and Herzegovina","Bosnia and Herzegovina","Bosnia and Herzegovina","Bulgaria","Bulgaria","Bulgaria","Bulgaria","Bulgaria","Bulgaria","Croatia","Croatia","Croatia","Croatia","Croatia","Cyprus","Czech Republic","Czech Republic","Czech Republic","Denmark","Denmark","Denmark","Denmark","Denmark","Estonia","Estonia","Estonia","Estonia","Finland","Finland","Finland","France","France","France","France","France","France","France","Germany","Germany","Germany","Germany","Germany","Germany","Greece","Greece","Hungary","Hungary","Hungary","Hungary","Hungary","Iceland","Iceland","Ireland","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Kosovo","Kosovo","Kosovo","Latvia","Latvia","Latvia","Liechtenstein","Lithuania","Lithuania","Lithuania","Macedonia","Moldova","Moldova","Montenegro","Netherlands","Norway","Norway","Norway","Poland","Poland","Poland","Poland","Portugal","Republic of Serbia","Romania","Romania","Romania","Russia","Russia","Slovakia"],"color":["red","blue","red","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","green","red","green","green","red","blue","red","green","green","green","green","red","green","blue","blue","green","blue","red","green","red","blue","green","green","green","red","blue","blue","blue","blue","blue","red","red","blue","green","red","red","green","red","green","red","red","green","blue","green","red","red","blue","green","blue","blue","green","green","green","green","green","green","blue","blue","red","blue","blue","green","red","blue","green","green","green","green","green","red","green","blue","green","green","red","blue","green","green","green","green","blue","red","red","blue","red","green","blue","green","red","green","blue","green","red","blue","red","green"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false}},"groups":null,"width":"1000px","height":"1000px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="cartoon-map" class="section level2">
<h2>Cartoon map</h2>
<pre class="r"><code>inx_dxf &lt;- tempfile(&quot;inx_&quot;, fileext = c(&quot;.dxf&quot;))
europe %&gt;%
  st_geometry() %&gt;%
  st_write(dsn = inx_dxf, driver =&quot;DXF&quot;)</code></pre>
<pre><code>## Writing layer `inx_46d47e7473f9&#39; to data source 
##   `C:\Users\jacek\AppData\Local\Temp\RtmpOKZXbD\inx_46d47e7473f9.dxf&#39; using driver `DXF&#39;
## Writing 77 features with 0 fields and geometry type Multi Polygon.</code></pre>
<pre class="r"><code># canvas 
canvas &lt;- matrix(c(-23, 30,
                   -23, 73,
                   45, 73,
                   45, 30,
                   -23, 30),ncol=2, byrow=TRUE) %&gt;%
  list() %&gt;% st_polygon() %&gt;% st_sfc() %&gt;% st_sf()
europe &lt;- st_read(inx_dxf) %&gt;% select(geometry) %&gt;%
  st_intersection(canvas)</code></pre>
<pre><code>## Reading layer `entities&#39; from data source 
##   `C:\Users\jacek\AppData\Local\Temp\RtmpOKZXbD\inx_46d47e7473f9.dxf&#39; 
##   using driver `DXF&#39;
## Simple feature collection with 433 features and 6 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: -180 ymin: -58.49229 xmax: 180 ymax: 83.59961
## CRS:           NA</code></pre>
<pre class="r"><code># offset
europe &lt;- europe %&gt;% 
  mutate(geometry = st_buffer(geometry, dist = -.1)) %&gt;%
  mutate(geometry = st_simplify(geometry)) %&gt;%
  mutate(area = st_area(geometry)) %&gt;%
  filter(area &gt; 0.1)

europe %&gt;% ggplot() +
  geom_sf() #+ theme_void()</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code># write svg
#europe %&gt;% inx_sf2svg() %&gt;% inx_write(&quot;/cartoon/europe.svg&quot;)</code></pre>
</div>
